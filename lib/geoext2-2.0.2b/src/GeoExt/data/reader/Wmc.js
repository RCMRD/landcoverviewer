Ext.define("GeoExt.data.reader.Wmc",{alternateClassName:["GeoExt.data.WMCReader"],extend:"Ext.data.reader.Json",alias:"reader.gx_wmc",requires:["GeoExt.Version"],constructor:function(n){this.model||(this.model="GeoExt.data.WmcLayerModel");this.callParent([n]);this.format||(this.format=new OpenLayers.Format.WMC)},getResponseData:function(n){var t=n.responseXML;return t&&t.documentElement||(t=n.responseText),this.readRecords(t)},readRecords:function(n){var i,f,e,r,s,u,h,t,o,c;if((typeof n=="string"||n.nodeType)&&(n=this.format.read(n)),i=n?n.layersContext:undefined,f=[],i)for(e=this.getFields(),r=0,s=i.length;r<s;r++){for(t=i[r],t.metadata=t.metadata||{},u=0,h=e.length;u<h;u++)o=e[u],t.metadata[o.name]=t[o.name];t.metadata.name=t.name;c=this.format.getLayerFromContext(t);f.push(c)}return this.callParent([f])}})