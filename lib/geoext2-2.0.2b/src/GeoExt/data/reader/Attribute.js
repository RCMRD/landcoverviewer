Ext.define("GeoExt.data.reader.Attribute",{extend:"Ext.data.reader.Json",requires:["GeoExt.Version","Ext.data.Field"],alternateClassName:"GeoExt.data.AttributeReader",alias:"reader.gx_attribute",keepRaw:!1,raw:null,config:{format:null,ignore:null,feature:null},constructor:function(n){this.model||(this.model="GeoExt.data.AttributeModel");this.callParent([n]);this.feature&&this.setFeature(this.feature)},destroyReader:function(){var n=this;delete n.raw;this.callParent()},applyFeature:function(n){var t=Ext.create("Ext.data.Field",{name:"value",defaultValue:undefined});return this.model.prototype.fields.add(t),n},getResponseData:function(n){var t=n.responseXML;return t&&t.documentElement||(t=n.responseText),this.readRecords(t)},readRecords:function(n){var r,s,e,y,o;this.getFormat()||this.setFormat(new OpenLayers.Format.WFSDescribeFeatureType);n instanceof Array?r=n:(s=this.getFormat().read(n),this.keepRaw&&(this.raw=s),r=s.featureTypes[0].properties);var c=this.feature,l=this.model.prototype.fields,p=l.length,a,i,u,f,t,v,h=[];for(e=0,y=r.length;e<y;++e){for(f=!1,a=r[e],i={},o=0;o<p;++o){if(v=l.items[o],u=v.name,t=a[u],this.ignoreAttribute(u,t)){f=!0;break}i[u]=t}c&&(t=c.attributes[i.name],t!==undefined&&(this.ignoreAttribute("value",t)?f=!0:i.value=t));f||(h[h.length]=i)}return this.callParent([h])},ignoreAttribute:function(n,t){var r=!1,i;return this.ignore&&this.ignore[n]&&(i=this.ignore[n],typeof i=="string"?r=i===t:i instanceof Array?r=Ext.Array.indexOf(i,t)>-1:i instanceof RegExp&&(r=i.test(t))),r}})