Ext.define("GeoExt.data.proxy.Protocol",{extend:"Ext.data.proxy.Server",requires:["GeoExt.Version"],alias:"proxy.gx_protocol",protocol:null,abortPrevious:!0,setParamsAsOptions:!1,response:null,doRequest:function(n,t,i){var f=this,u=Ext.applyIf(n.params||{},f.extraParams||{}),e,o,r;u=Ext.applyIf(u,f.getParams(n));e={params:u||{},operation:n,request:{callback:t,scope:i,arg:n.arg},reader:this.getReader()};o=OpenLayers.Function.bind(this.loadResponse,this,e);this.abortPrevious&&this.abortRequest();r={params:u,callback:o,scope:this};Ext.applyIf(r,n.arg);this.setParamsAsOptions===!0&&(Ext.applyIf(r,r.params),delete r.params);this.response=this.protocol.read(r)},abortRequest:function(){this.response&&(this.protocol.abort(this.response),this.response=null)},loadResponse:function(n,t){var r=this,i=n.operation,e=n.request.scope,f=n.request.callback,u;t.success()?(u=n.reader.read(t.features||t),Ext.apply(i,{response:t,resultSet:u}),i.commitRecords(u.records),i.setCompleted(),i.setSuccessful()):(r.setException(i,t),r.fireEvent("exception",this,t,i));typeof f=="function"&&f.call(e||r,i)}})