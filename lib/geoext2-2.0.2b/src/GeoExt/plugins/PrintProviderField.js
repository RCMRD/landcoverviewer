Ext.define("GeoExt.plugins.PrintProviderField",{mixins:{observable:"Ext.util.Observable"},requires:["GeoExt.data.MapfishPrintProvider","Ext.form.field.ComboBox"],alias:"widget.gx_printproviderfield",alternateClassName:"GeoExt.PrintProviderField",target:null,constructor:function(n){this.initialConfig=n;Ext.apply(this,n);this.callParent(arguments)},init:function(n){this.target=n;var t={scope:this,render:this.onRender,beforedestroy:this.onBeforeDestroy};t[n instanceof Ext.form.ComboBox?"select":"change"]=this.onFieldChange;n.on(t)},onRender:function(n){var t=this.printProvider||n.ownerCt.printProvider;if(n.store===t.layouts){n.setValue(t.layout.get(n.displayField));t.on({layoutchange:this.onProviderChange,scope:this})}else if(n.store===t.dpis){n.setValue(t.dpi.get(n.displayField));t.on({dpichange:this.onProviderChange,scope:this})}else n.initialConfig.value===undefined&&n.setValue(t.customParams[n.name])},onFieldChange:function(n,t){var r,i,u;if(r=Ext.isArray(t)?t[0]:t,i=this.printProvider||n.ownerCt.printProvider,u=n.getValue(),this._updating=!0,r)switch(n.store){case i.layouts:i.setLayout(r);break;case i.dpis:i.setDpi(r)}else i.customParams[n.name]=u;delete this._updating},onProviderChange:function(n,t){this._updating||this.target.setValue(t.get(this.target.displayField))},onBeforeDestroy:function(){var n=this.target,t;n.un("beforedestroy",this.onBeforeDestroy,this);n.un("render",this.onRender,this);n.un("select",this.onFieldChange,this);n.un("valid",this.onFieldChange,this);t=this.printProvider||n.ownerCt.printProvider;t.un("layoutchange",this.onProviderChange,this);t.un("dpichange",this.onProviderChange,this)}})