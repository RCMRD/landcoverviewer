Ext.define("GeoExt.LegendImage",{extend:"Ext.Component",alias:"widget.gx_legendimage",requires:["GeoExt.Version"],url:null,defaultImgSrc:null,imgCls:null,noImgCls:"gx-legend-noimage",initComponent:function(){var n=this;n.addEvents("legendimageloaded");n.callParent(arguments);this.defaultImgSrc===null&&(this.defaultImgSrc=Ext.BLANK_IMAGE_URL);this.autoEl={tag:"img","class":this.imgCls?this.imgCls+" "+this.noImgCls:this.noImgCls,src:this.defaultImgSrc}},setUrl:function(n){this.url=n;var t=this.getEl();if(t){t.un("load",this.onImageLoad,this);t.on("load",this.onImageLoad,this,{single:!0});t.un("error",this.onImageLoadError,this);t.on("error",this.onImageLoadError,this,{single:!0});t.dom.src=n}},onRender:function(){this.callParent(arguments);this.url&&this.setUrl(this.url)},onDestroy:function(){var n=this.getEl();n&&(n.un("load",this.onImageLoad,this),n.un("error",this.onImageLoadError,this));this.callParent()},onImageLoadError:function(){var n=this.getEl();n.addCls(this.noImgCls);n.dom.src=this.defaultImgSrc},onImageLoad:function(){var n=this.getEl();OpenLayers.Util.isEquivalentUrl(n.dom.src,this.defaultImgSrc)||n.removeCls(this.noImgCls);this.fireEvent("legendimageloaded",this)}})