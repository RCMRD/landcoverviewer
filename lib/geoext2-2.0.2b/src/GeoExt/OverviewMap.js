Ext.define("GeoExt.OverviewMap",{extend:"Ext.Component",alias:"widget.gx_overviewmap",requires:["GeoExt.Version"],ovCls:"gx-overview-map",map:null,dynamic:!1,overviewOptions:null,ctrl:null,initComponent:function(){this.map||(this.map=GeoExt.panel.Map.guess().map);this.addCls(this.ovCls);this.on({show:this.reinitControl,resize:this.reinitControl,hide:this.destroyControl,scope:this});if(this.dynamic)this.map.events.on({changebaselayer:this.reinitControl,scope:this});this.callParent()},destroy:function(){this.destroyControl();this.un({show:this.reinitControl,resize:this.reinitControl,hide:this.destroyControl,scope:this});this.map.events.un({changebaselayer:this.onChangeBaseLayer,scope:this});delete this.ctrl;delete this.map;delete this.overviewOptions;this.callParent(arguments)},reinitControl:function(){this.destroyControl();this.initControl()},initControl:function(){var n=this.map,r=this.getSize(),t=Ext.apply({div:this.getEl().dom,size:new OpenLayers.Size(r.width,r.height),maximized:!0},this.overviewOptions),i;n.allOverlays&&!t.layers&&n.layers&&n.layers.length>0&&(i=n.layers[0].clone(),i.setIsBaseLayer(!0),t.layers=[i]);this.ctrl=new OpenLayers.Control.OverviewMap(t);n.addControl(this.ctrl)},destroyControl:function(){this.ctrl&&this.ctrl instanceof OpenLayers.Control.OverviewMap&&(this.map.removeControl(this.ctrl),this.ctrl.destroy())}})